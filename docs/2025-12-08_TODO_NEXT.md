# 2025-12-08 TODO List

## 優先度: 高 (Critical)

- [ ] **解約機能の修正完了 (Cancellation Fix)**
    - 現状: `API Error` が継続中（401または404の可能性）。
    - 原因調査: サーバーログの特定、DB内のEmail保存形式（大文字・小文字）の確認。
    - 対策: `lib/table.js` の修正は完了済みだが、既存データとの不整合が疑われる。

- [ ] **AI応答速度の改善 (Improve AI Latency)**
    - 現状: ユーザーより「AIの返答が非常に遅い」との報告あり。
    - タスク:
        - Azure OpenAIのモデル（gpt-4o-mini vs gpt-4o）の確認。
        - タイムアウト設定の確認。
        - ストリーミング応答の検討（現在は一括応答待機になっている可能性）。

## 優先度: 中 (Important)

- [ ] **認証環境の完全リセット検討 (Auth Environment Reset)**
    - ユーザー提案: 「一度全部認証まわりに関して全部リセットした方がいいならリセットする」。
    - 手順案: Azure Table Storage (`Users`, `Subscriptions`) の全データ削除、拡張機能のローカルストレージクリア、Stripeのテストデータパージ。
    - 注意: 既存のテストアカウントは全て無効になります。

- [ ] **再契約ロジックの検証**: [2025-12-08_RESUBSCRIPTION_SPEC_V1.md](2025-12-08_RESUBSCRIPTION_SPEC_V1.md) に基づき、解約済みユーザーが再契約した際の挙動（新規トークン発行+既存ID維持）を検証する。

## 文書関連
- [ ] **ユーザーガイド更新**: Success Pageでの「トークンコピー」フローに合わせて、ユーザーガイドを更新してください。

## 完了済み (2025-12-08)
- [x] **Direct Paste デフォルト値変更**: `TEMPLATES_DIRECT_PASTE` を `true` に変更。
- [x] **仕様書リネーム**: `RESUBSCRIPTION_SPEC.md` を日付・バージョン付きに変更。
- [x] **ログアウト機能実装**: サイドパネルにログアウトボタンを追加（トークンリセット用）。
- [x] **Email正規化対応**: Azure Functions (`lib/table.js`) でメールアドレスの小文字化を強制するように修正。
