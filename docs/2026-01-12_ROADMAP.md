# 今後の方針 (2026-01-12)

## 現在の状態

- **Google Web Store**: v0.2.5 審査中/公開済み
- **内部版**: v0.2.52 完成
- **サーバー**: past_due対応済み（要デプロイ）

---

## 短期ロードマップ

### v0.2.6x - APIM導入

**優先度**: 高

| タスク | 詳細 |
|--------|------|
| API_BASE_URL変更 | Functions直接 → APIM経由 |
| Rate Limiting | API呼び出し制限の設定 |
| 監視強化 | Application Insights連携 |
| エラーハンドリング | APIM側でのエラーレスポンス統一 |

**変更ファイル**:
- `extensions/utils/api.js` - API_BASE_URL
- Azure Portal - APIM設定

---

### v0.2.7x - 機能改善（予定）

| 候補 | 詳細 |
|------|------|
| host_permissions最適化 | `<all_urls>` → 特定ドメインに制限 |
| トークン検証分離 | check-subscriptionから独立したエンドポイント |
| オフライン対応強化 | キャッシュ戦略の改善 |

---

## 中期ロードマップ

### セキュリティ強化

- [ ] host_permissionsの制限（対象ドメイン特定後）
- [ ] トークンリフレッシュ機能
- [ ] 監査ログ強化

### UX改善

- [ ] サブスク状態のリアルタイム通知
- [ ] エラーメッセージの改善
- [ ] オンボーディングフロー

### 運用効率化

- [ ] 自動デプロイパイプライン
- [ ] E2Eテスト整備
- [ ] ドキュメント自動生成

---

## バージョニング方針

```
Google公開版: 0.2.X（例: 0.2.5, 0.2.6, 0.2.7）
内部パッチ版: 0.2.X1, 0.2.X2...（例: 0.2.51, 0.2.52）
```

- Googleにアップ後、3桁目でパッチを管理
- 大きな機能追加は2桁目を上げる

---

## 次回作業予定

1. **Azure Functions デプロイ**
   - `check-subscription` の past_due 対応を本番反映

2. **APIM設定確認**
   - 既存のAPIM設定を確認
   - エンドポイント移行計画策定

3. **v0.2.6x 開発開始**
   - API_BASE_URL の切り替え
   - テスト環境での動作確認

---

## 参考ドキュメント

- [v0.2.5x サブスクリプション要件](./v0.2.5x_SUBSCRIPTION_REQUIREMENTS.md)
- [CHANGELOG](../extensions/CHANGELOG.txt)
